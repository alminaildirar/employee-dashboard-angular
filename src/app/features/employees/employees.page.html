<h1>Employees</h1>

@if (store.isLoading()) {
<p>Loading...</p>
} @else if (store.error()) {
<p class="error">{{ store.error() }}</p>
<button type="button" (click)="store.refresh()">Retry</button>
} @else {
<!-- =========================
       Actions
       ========================= -->
<div class="actions">
  <button type="button" routerLink="/employees/new">Add employee</button>

  <button type="button" (click)="store.refresh()">Refresh</button>
</div>

<div class="toolbar">
  <input
    type="text"
    placeholder="Search name or email…"
    [value]="store.query()"
    (input)="store.query.set(($any($event.target).value || '').toString())"
  />

  <select
    [value]="store.roleFilter()"
    (change)="store.roleFilter.set($any($event.target).value)"
  >
    <option value="all">All roles</option>
    <option value="Engineer">Engineer</option>
    <option value="Manager">Manager</option>
    <option value="HR">HR</option>
  </select>

  <select
    [value]="store.statusFilter()"
    (change)="store.statusFilter.set($any($event.target).value)"
  >
    <option value="all">All statuses</option>
    <option value="ACTIVE">ACTIVE</option>
    <option value="INACTIVE">INACTIVE</option>
  </select>

  <select
    [value]="store.sortBy()"
    (change)="store.sortBy.set($any($event.target).value)"
  >
    <option value="name">Sort: Name</option>
    <option value="role">Sort: Role</option>
    <option value="status">Sort: Status</option>
  </select>
</div>

@if (!store.isLoading() && !store.error() && store.count() === 0) {
<p class="empty">0 sonuç bulundu.</p>
}
<div class="table">
  <div class="row head">
    <div>Name</div>
    <div>Email</div>
    <div>Role</div>
    <div>Status</div>
  </div>

  @for (e of store.filteredEmployees(); track e.id) {
  <div class="row" appHighlightOnHover>
    <div>
      <a class="name" [routerLink]="['/employees', e.id]"> {{ e.fullName }} </a>
    </div>

    <div class="muted">{{ e.email }}</div>

    <div>{{ e.role }}</div>

    <div>
      <span class="badge" [class.inactive]="e.status === 'INACTIVE'">
        {{ e.status }}
      </span>
    </div>
  </div>
  }
</div>
}
